This is the ninth likelihood test in the
[LikelihoodTest.java](https://github.com/beast-dev/beast-mcmc/blob/master/src/test/dr/evomodel/treelikelihood/LikelihoodTest.java) file in BEAST.
It expects the log likelihood `-1947.58294`
for a sequence alignment from several primate taxa,
given a known tree, under GTR evolution with a mixture of rates across sites.

The nucleotide stationary distribution that is used to
define the prior state distribution at the root and to construct
the rate matrix is computed empirically using a tree-free
PAUP-compatible EM-like algorithm that ignores internal nodes
and treats alignment gaps at tip nodes as missing nucleotides.
The iterative algorithm terminates according to ad-hoc criteria.

The gamma distribution of rates across sites is discretized
with four categories using normalized median rates
and gamma shape parameter `0.5`.
Additionally, each site has a `0.5` prior probability of invariability.

Command:
```shell
$ arbplf-ll < in.json > out.json
```

Output (out.json):
```json
{"columns": ["value"], "data": [[-1947.5829394654481]]}
```

Input (in.json):
```json
{
  "model_and_data": {
    "edges": [
      [10, 8],
      [8, 6],
      [6, 4],
      [4, 0],
      [4, 3],
      [3, 1],
      [3, 2],
      [6, 5],
      [8, 7],
      [10, 9]], 
    "edge_rate_coefficients": [
      0.030457, 
      0.033087, 
      0.012035, 
      0.024003, 
      0.013231, 
      0.010772, 
      0.010772, 
      0.036038, 
      0.069125, 
      0.099582],
    "root_prior" : [
      0.26121198857732775,
      0.24655436448599188,
      0.33909428971935046,
      0.1531393572173299],
    "normalized_median_gamma_rate_mixture": {
      "invariable_prior": 0.5, 
      "gamma_categories": 4, 
      "gamma_shape": 0.5}, 
    "rate_matrix": [
      [0, 0.24655436448599188, 0.33909428971935046, 0.1531393572173299], 
      [0.26121198857732775, 0, 0.33909428971935046, 0.1531393572173299], 
      [0.26121198857732775, 0.24655436448599188, 0, 0.1531393572173299],
      [0.26121198857732775, 0.24655436448599188, 0.33909428971935046, 0]], 
    "rate_divisor": "equilibrium_exit_rate",
    "character_definitions" : [
      [1, 0, 0, 0],
      [0, 1, 0, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 1],
      [1, 1, 1, 1]],
    "character_data" : [
      [1, 0, 1, 4, 4, 1, 4, 1, 4, 1, 4],
      [3, 2, 2, 4, 4, 3, 4, 2, 4, 3, 4],
      [2, 2, 2, 4, 4, 2, 4, 2, 4, 3, 4],
      [1, 1, 0, 4, 4, 1, 4, 1, 4, 0, 4],
      [2, 3, 3, 4, 4, 3, 4, 3, 4, 3, 4],
      [0, 1, 0, 4, 4, 1, 4, 1, 4, 0, 4],
      [1, 1, 1, 4, 4, 0, 4, 1, 4, 1, 4],
      [2, 2, 3, 4, 4, 2, 4, 2, 4, 3, 4],
      [0, 0, 1, 4, 4, 0, 4, 1, 4, 0, 4],
      [2, 2, 2, 4, 4, 2, 4, 1, 4, 3, 4],
      [0, 0, 0, 4, 4, 0, 4, 0, 4, 1, 4],
      [3, 2, 2, 4, 4, 3, 4, 3, 4, 3, 4],
      [2, 2, 2, 4, 4, 3, 4, 3, 4, 2, 4],
      [2, 3, 3, 4, 4, 0, 4, 2, 4, 2, 4],
      [1, 0, 0, 4, 4, 1, 4, 1, 4, 1, 4],
      [0, 0, 0, 4, 4, 0, 4, 1, 4, 1, 4],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 1, 4],
      [2, 3, 2, 4, 4, 3, 4, 2, 4, 2, 4],
      [1, 1, 1, 4, 4, 1, 4, 0, 4, 0, 4],
      [1, 1, 1, 4, 4, 1, 4, 1, 4, 2, 4],
      [1, 1, 1, 4, 4, 0, 4, 0, 4, 1, 4],
      [2, 2, 2, 4, 4, 3, 4, 3, 4, 1, 4],
      [2, 2, 2, 4, 4, 2, 4, 3, 4, 2, 4],
      [1, 1, 0, 4, 4, 1, 4, 1, 4, 1, 4],
      [2, 3, 2, 4, 4, 2, 4, 4, 4, 2, 4],
      [0, 0, 0, 4, 4, 1, 4, 1, 4, 0, 4],
      [0, 0, 0, 4, 4, 1, 4, 0, 4, 0, 4],
      [0, 0, 0, 4, 4, 0, 4, 2, 4, 0, 4],
      [2, 2, 3, 4, 4, 2, 4, 2, 4, 2, 4],
      [1, 0, 0, 4, 4, 1, 4, 0, 4, 0, 4],
      [1, 0, 0, 4, 4, 1, 4, 1, 4, 0, 4],
      [2, 2, 2, 4, 4, 3, 4, 3, 4, 3, 4],
      [0, 1, 1, 4, 4, 1, 4, 1, 4, 1, 4],
      [1, 0, 0, 4, 4, 0, 4, 1, 4, 0, 4],
      [1, 0, 0, 4, 4, 0, 4, 0, 4, 0, 4],
      [2, 2, 2, 4, 4, 0, 4, 2, 4, 2, 4],
      [1, 1, 1, 4, 4, 1, 4, 0, 4, 1, 4],
      [2, 2, 2, 4, 4, 2, 4, 3, 4, 3, 4],
      [0, 0, 0, 4, 4, 0, 4, 1, 4, 0, 4],
      [3, 3, 3, 4, 4, 3, 4, 3, 4, 3, 4],
      [0, 0, 0, 4, 4, 0, 4, 1, 4, 3, 4],
      [3, 3, 3, 4, 4, 3, 4, 2, 4, 3, 4],
      [1, 1, 1, 4, 4, 1, 4, 1, 4, 1, 4],
      [2, 2, 2, 4, 4, 2, 4, 2, 4, 2, 4],
      [2, 2, 2, 4, 4, 3, 4, 2, 4, 3, 4],
      [2, 2, 2, 4, 4, 2, 4, 1, 4, 2, 4],
      [4, 4, 4, 4, 4, 4, 4, 2, 4, 4, 4],
      [3, 2, 3, 4, 4, 3, 4, 3, 4, 2, 4],
      [4, 4, 4, 4, 4, 4, 4, 1, 4, 4, 4],
      [1, 1, 1, 4, 4, 0, 4, 1, 4, 0, 4],
      [1, 1, 1, 4, 4, 0, 4, 0, 4, 0, 4],
      [3, 2, 2, 4, 4, 2, 4, 3, 4, 2, 4],
      [2, 1, 2, 4, 4, 2, 4, 2, 4, 2, 4],
      [2, 2, 2, 4, 4, 2, 4, 4, 4, 2, 4],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 4],
      [0, 1, 1, 4, 4, 1, 4, 0, 4, 1, 4],
      [0, 0, 0, 4, 4, 1, 4, 1, 4, 2, 4],
      [3, 3, 3, 4, 4, 3, 4, 3, 4, 2, 4],
      [2, 2, 2, 4, 4, 3, 4, 2, 4, 2, 4],
      [2, 2, 2, 4, 4, 2, 4, 3, 4, 1, 4],
      [4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 4],
      [0, 1, 0, 4, 4, 0, 4, 1, 4, 0, 4],
      [0, 1, 0, 4, 4, 0, 4, 0, 4, 0, 4],
      [0, 0, 0, 4, 4, 0, 4, 0, 4, 0, 4],
      [1, 1, 1, 4, 4, 1, 4, 1, 4, 0, 4],
      [3, 3, 3, 4, 4, 3, 4, 2, 4, 2, 4],
      [3, 2, 2, 4, 4, 2, 4, 2, 4, 2, 4],
      [0, 0, 0, 4, 4, 0, 4, 0, 4, 2, 4],
      [3, 3, 3, 4, 4, 2, 4, 2, 4, 3, 4]]},
  "site_reduction" : {
    "aggregation" : [
      1, 1, 8, 1, 1, 1, 4, 1, 1, 1, 12, 1, 2, 1, 1, 6, 2, 1, 3, 2,
      1, 1, 9, 1, 1, 1, 3, 1, 1, 2, 1, 1, 4, 2, 3, 1, 5, 2, 9, 99,
      1, 2, 148, 221, 1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, 1, 1, 4, 4, 1,
      1, 1, 1, 155, 8, 1, 3, 1, 1]}
}
```
